{"ast":null,"code":"import _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nexport var SpreadsheetHelper =\n/*#__PURE__*/\nfunction () {\n  function SpreadsheetHelper() {\n    _classCallCheck(this, SpreadsheetHelper);\n  }\n\n  _createClass(SpreadsheetHelper, null, [{\n    key: \"validateFileType\",\n    value: function validateFileType(type) {\n      var types = [\"application/vnd.oasis.opendocument.spreadsheet\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\", \"application/json\"];\n      return types.include(type);\n    }\n  }, {\n    key: \"readColums\",\n    value: function readColums(file) {\n      var reader = new FileReader();\n\n      reader.onload = function (e) {\n        var result = e.target.result,\n            json;\n        console.log(e.target.result); // if(type===\"json\"){json=result;}//if json\n        // else{//spreadsheet\n        // \tlet sheet = XLSX.read(result,{type:'binary'});\n        // \tlet\tsheetName = sheet.SheetNames[0] || sheet.Workbook.Sheets[0].name;\n        // \tlet\tjsObject = XLSX.utils.sheet_to_json(sheet.Sheets[sheetName]);\n        // \tlet filter = [\"firstName\",\"lastName\",\"otherName\",\"gender\",\"staffId\",\"phone\",\"studentId\",\"house\",\"pin\",\"serial\",\"currentClass\",\"ca1\",\"ca2\",\"exam\",\"position\",\"homeWork\",\"classWork\",\"name\"];\n        // \tjson = JSON.stringify(jsObject,filter,4);\n        // }\n        // sessionStorage.setItem(\"importJSON\",json);\n      };\n\n      reader.readAsDataURL(file); // reader.readAsBinaryString(file);\n    }\n  }]);\n\n  return SpreadsheetHelper;\n}();","map":{"version":3,"sources":["/home/abdulhakeem/Express/exsender/utils/fileHelpers.js"],"names":["SpreadsheetHelper","type","types","include","file","reader","FileReader","onload","e","result","target","json","console","log","readAsDataURL"],"mappings":";;AAAA,WAAaA,iBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,qCACyBC,IADzB,EAC+B;AAC7B,UAAIC,KAAK,GAAG,CACX,gDADW,EAEX,mEAFW,EAGX,kBAHW,CAAZ;AAKA,aAAOA,KAAK,CAACC,OAAN,CAAcF,IAAd,CAAP;AACA;AARF;AAAA;AAAA,+BAUmBG,IAVnB,EAUqC;AACnC,UAAIC,MAAM,GAAG,IAAIC,UAAJ,EAAb;;AACCD,MAAAA,MAAM,CAACE,MAAP,GAAgB,UAASC,CAAT,EAAW;AAE1B,YAAIC,MAAM,GAAGD,CAAC,CAACE,MAAF,CAASD,MAAtB;AAAA,YAA8BE,IAA9B;AACAC,QAAAA,OAAO,CAACC,GAAR,CAAYL,CAAC,CAACE,MAAF,CAASD,MAArB,EAH0B,CAI1B;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAdD;;AAeDJ,MAAAA,MAAM,CAACS,aAAP,CAAqBV,IAArB,EAjBmC,CAkBnC;AACA;AA7BF;;AAAA;AAAA","sourcesContent":["export class SpreadsheetHelper {\n\tstatic validateFileType(type) {\n\t\tlet types = [\n\t\t\t\"application/vnd.oasis.opendocument.spreadsheet\",\n\t\t\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\n\t\t\t\"application/json\"\n\t\t];\n\t\treturn types.include(type);\n\t}\n\n\tstatic readColums(file, ...columns) {\n\t\tlet reader = new FileReader();\n\t\t\treader.onload = function(e){\n\n\t\t\t\tlet result = e.target.result, json;\n\t\t\t\tconsole.log(e.target.result);\n\t\t\t\t// if(type===\"json\"){json=result;}//if json\n\t\t\t\t\n\t\t\t\t// else{//spreadsheet\n\t\t\t\t// \tlet sheet = XLSX.read(result,{type:'binary'});\n\t\t\t\t// \tlet\tsheetName = sheet.SheetNames[0] || sheet.Workbook.Sheets[0].name;\n\t\t\t\t// \tlet\tjsObject = XLSX.utils.sheet_to_json(sheet.Sheets[sheetName]);\n\t\t\t\t// \tlet filter = [\"firstName\",\"lastName\",\"otherName\",\"gender\",\"staffId\",\"phone\",\"studentId\",\"house\",\"pin\",\"serial\",\"currentClass\",\"ca1\",\"ca2\",\"exam\",\"position\",\"homeWork\",\"classWork\",\"name\"];\n\t\t\t\t// \tjson = JSON.stringify(jsObject,filter,4);\n\t\t\t\t// }\n\t\t\t\t// sessionStorage.setItem(\"importJSON\",json);\n\t\t\t}\n\t\treader.readAsDataURL(file);\n\t\t// reader.readAsBinaryString(file);\n\t}\n}\n"]},"metadata":{},"sourceType":"module"}